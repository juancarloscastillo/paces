theme(plot.title = element_markdown(hjust=-0.35),
legend.position = "none",
plot.subtitle = element_markdown(hjust = 0.5))
plot_p33B
data_p33C=data %>% select(P33C,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33C <- na.omit(data_p33C)
data_p33C$P33C <- factor(data_p33C$P33C, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33C <- data_p33C %>%
group_by("Alternativas"=P33C) %>%
summarise(counts = n())
pondp33C <- freq(data_p33C$P33C, weights = data_p33C$pond_estudiante_reg_dep_tens)
p33C$prop <- pondp33C[1:2,4]
p33C <- p33C %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33C <- ggplot(p33C, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =16)) +
ggtitle(" ",subtitle="<br><br><br><br><br><strong><span style='font-size:28px'>
Participar en una marcha <br>
o manifestación que resultó<br>
en destrucción de propiedad</span></strong>") +
theme(plot.title = element_markdown(hjust=0),
legend.position = "none",
plot.subtitle = element_markdown(hjust = 0.5))
plot_p33C
data_p33D=data %>% select(P33D,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33D <- na.omit(data_p33D)
data_p33D$P33D <- factor(data_p33D$P33D, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33D <- data_p33D %>%
group_by("Alternativas"=P33D) %>%
summarise(counts = n())
pondp33D <- freq(data_p33D$P33D, weights = data_p33D$pond_estudiante_reg_dep_tens)
p33D$prop <- pondp33D[1:2,4]
p33D <- p33D %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33D <- ggplot(p33D, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<strong><span style='font-size:28px'>Participar en una toma</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p33D
partact2a <- cowplot::plot_grid(plot_p33B,plot_p33C, ncol=2)
partact2b <- cowplot::plot_grid(plot_p33D,plot_p33A, ncol=2)
partact2 <- cowplot::plot_grid(partact2a,partact2b, ncol=1)
ggsave(partact2, file = "../output/graphs/graph_partact.png",device = "png",width = 30,height = 35,dpi = "retina",units = "cm")
data_p30G=data %>% select(P30G,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p30G <- na.omit(data_p30G)
data_p30G$P30G <- factor(data_p30G$P30G, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p30G <- data_p30G %>%
group_by("Alternativas"=P30G) %>%
summarise(counts = n())
pondp30G <- freq(data_p30G$P30G, weights = data_p30G$pond_estudiante_reg_dep_tens)
p30G$prop <- pondp30G[1:2,4]
p30G <- p30G %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p30G <- ggplot(p30G, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<br><br><br><br><strong><span style='font-size:28px'>Trabajos voluntarios <br> de ayuda</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p30G
data_p30H=data %>% select(P30H,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p30H <- na.omit(data_p30H)
data_p30H$P30H <- factor(data_p30H$P30H, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p30H <- data_p30H %>%
group_by("Alternativas"=P30H) %>%
summarise(counts = n())
pondp30H <- freq(data_p30H$P30H, weights = data_p30H$pond_estudiante_reg_dep_tens)
p30H$prop <- pondp30H[1:2,4]
p30H <- p30H %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p30H <- ggplot(p30H, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("<br><br><br><strong><span style='font-size:25px'>¿Has realizado la siguiente actividad al interior de la escuela durante <br> los últimos dos semestres?</span></strong><br>",subtitle="<strong><span style='font-size:28px'>
Colectas de dineros o bienes <br> para ayudar a otros</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
legend.position = "bottom",
plot.subtitle = element_markdown(hjust = 0.5),
legend.title = element_blank())
plot_p30H
data_p30I=data %>% select(P30I,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p30I <- na.omit(data_p30I)
data_p30I$P30I <- factor(data_p30I$P30I, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p30I <- data_p30I %>%
group_by("Alternativas"=P30I) %>%
summarise(counts = n())
pondp30I <- freq(data_p30I$P30I, weights = data_p30I$pond_estudiante_reg_dep_tens)
p30I$prop <- pondp30I[1:2,4]
p30I <- p30I %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p30I <- ggplot(p30I, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<br><br><br><br><strong><span style='font-size:28px'>Actividades de ayuda <br> a la comunidad</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p30I
partcom1 <- cowplot::plot_grid(plot_p30G,plot_p30H,plot_p30I, ncol=3)
ggsave(partcom1, file = "../output/graphs/graph_partcom_esc.png",device = "png",width = 30,height = 20,dpi = "retina",units = "cm")
data_p33E=data %>% select(P33E,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33E <- na.omit(data_p33E)
data_p33E$P33E <- factor(data_p33E$P33E, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33E <- data_p33E %>%
group_by("Alternativas"=P33E) %>%
summarise(counts = n())
pondp33E <- freq(data_p33E$P33E, weights = data_p33E$pond_estudiante_reg_dep_tens)
p33E$prop <- pondp33E[1:2,4]
p33E <- p33E %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33E <- ggplot(p33E, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<br><br><br><br><br><strong><span style='font-size:28px'>Donar dinero por <br> una buena causa</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p33E
data_p33F=data %>% select(P33F,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33F <- na.omit(data_p33F)
data_p33F$P33F <- factor(data_p33F$P33F, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33F <- data_p33F %>%
group_by("Alternativas"=P33F) %>%
summarise(counts = n())
pondp33F <- freq(data_p33F$P33F, weights = data_p33F$pond_estudiante_reg_dep_tens)
p33F$prop <- pondp33F[1:2,4]
p33F <- p33F %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33F <- ggplot(p33F, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("<br><br><br><strong><span style='font-size:25px'>¿Has realizado la siguiente actividad durante los últimos 12 meses?</span></strong><br>",subtitle="<strong><span style='font-size:28px'> <br>
Trabajar como <br>
voluntario por ayudar <br>
personas de tu comunidad</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
legend.position = "bottom",
plot.subtitle = element_markdown(hjust = 0.5),
legend.title = element_blank())
plot_p33F
data_p33G=data %>% select(P33G,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33G <- na.omit(data_p33G)
data_p33G$P33G <- factor(data_p33G$P33G, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33G <- data_p33G %>%
group_by("Alternativas"=P33G) %>%
summarise(counts = n())
pondp33G <- freq(data_p33G$P33G, weights = data_p33G$pond_estudiante_reg_dep_tens)
p33G$prop <- pondp33G[1:2,4]
p33G <- p33G %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33G <- ggplot(p33G, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<br><br><br><br><strong><span style='font-size:28px'> Participar de una <br>
actividad social en la <br>
comunidad en que vives</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p33G
partcom2 <- cowplot::plot_grid(plot_p33E,plot_p33F,plot_p33G, ncol=3)
ggsave(partcom2, file = "../output/graphs/graph_partcom.png",device = "png",width = 30,height = 20,dpi = "retina",units = "cm")
# Estudiantes
data_p52E=data %>% select(P52E,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p52E <- na.omit(data_p52E)
data_p52E$P52E <- factor(data_p52E$P52E, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada importante</strong></b>
<br>", "
<br>
<strong>
Algo importante</strong></b>
<br>", "
<br>
<strong>
Importante</strong></b>
<br>","
<br>
<strong>
Muy importante</strong></b>
<br>
"))
p52E <- data_p52E %>%
group_by("Alternativas"=P52E) %>%
summarise(counts = n())
pondp52E <- freq(data_p52E$P52E, weights = data_p52E$pond_estudiante_reg_dep_tens)
p52E$prop <- pondp52E[1:4,4]
p52E <- p52E %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p52E <- ggplot(p52E, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("<strong><span style='font-size:25px'>¿Qué tan importante cree usted que debería ser el siguiente aspecto <br> en la formación ciudadana de los estudiantes?</span></strong></b> <br> <br>
<strong><span style='font-size:28px'>El respeto y cumplimiento de la ley</span></strong> <br>", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"),
legend.position = "bottom",
legend.title = element_blank())
plot_p52E
# Docentes
dataprof_p27E=dataprof %>% select(P27E,pond_prof_reg_dep_tens) %>% as.data.frame
dataprof_p27E <- na.omit(dataprof_p27E)
dataprof_p27E$P27E <- factor(dataprof_p27E$P27E, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada importante</strong></b>
<br>", "
<br>
<strong>
Algo importante</strong></b>
<br>", "
<br>
<strong>
Importante</strong></b>
<br>","
<br>
<strong>
Muy importante</strong></b>
<br>
"))
p27E <- dataprof_p27E %>%
group_by("Alternativas"=P27E) %>%
summarise(counts = n())
pondprof27E <- freq(dataprof_p27E$P27E, weights = dataprof_p27E$pond_prof_reg_dep_tens)
p27E$prop <- pondprof27E[2:4,4]
p27E <- p27E %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_prof_p27E <- ggplot(p27E, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_manual(values = c("#CBC9E2","#9E9AC8", "#6A51A3","#6A51A3")) +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ", subtitle="
Respuestas de los docentes") +
theme(plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"),
legend.position = "none")
plot_prof_p27E
# Apoderados
dataapod_p34E=dataapod %>% select(P34E,pond_apoderado_reg_dep_tens) %>% as.data.frame
dataapod_p34E <- na.omit(dataapod_p34E)
dataapod_p34E$P34E <- factor(dataapod_p34E$P34E, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada importante</strong></b>
<br>", "
<br>
<strong>
Algo importante</strong></b>
<br>", "
<br>
<strong>
Importante</strong></b>
<br>","
<br>
<strong>
Muy importante</strong></b>
<br>
"))
p34E <- dataapod_p34E %>%
group_by("Alternativas"=P34E) %>%
summarise(counts = n())
pondapodp34E <- freq(dataapod_p34E$P34E, weights = dataapod_p34E$pond_apoderado_reg_dep_tens)
p34E$prop <- pondapodp34E[1:4,4]
p34E <- p34E %>%
arrange(desc(Alternativas)) %>%
mutate(
lab.ypos = cumsum(prop) - 0.5*prop)
plot_apod_p34E <- ggplot(p34E, aes(x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ", subtitle="
Respuestas de los apoderados") +
theme(plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"),
legend.position = "none")
plot_apod_p34E
## Gráfico
for_ciud5 <- cowplot::plot_grid(plot_prof_p27E,plot_p52E,plot_apod_p34E, ncol=3)
ggsave(for_ciud5, file = "../output/graphs/graph_for_ciud5.png",device = "png",width = 30,height = 20,dpi = "retina",units = "cm")
View(pregunta_2019)
View(table_pertot)
data_p1a=data %>% select(P1_A,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p1a <- na.omit(data_p1a)
weighted.mean(data_p1a$P1_A, data_p1a$pond_estudiante_reg_dep_tens)
pregunta_2009<- rbind(psych::describe(data2009$CI2RDM2_A),
psych::describe(data2009$CI2RDM2_B),psych::describe(data2009$CI2RDM2_C),psych::describe(data2009$CI2RDM2_D))
pregunta_2009 <- pregunta_2009 %>% select(n,mean,sd,median,trimmed,min,max)
#pregunta_2019<- rbind(psych::describe(data$P1_A),
#              psych::describe(data$P1_B),psych::describe(data$P1_C),psych::describe(data$P1_D))
data_p1a=data %>% select(P1_A,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p1a <- na.omit(data_p1a)
datap1a <- weighted.mean(data_p1a$P1_A, data_p1a$pond_estudiante_reg_dep_tens)
data_p1b=data %>% select(P1_B,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p1b <- na.omit(data_p1b)
datap1b <- weighted.mean(data_p1b$P1_B, data_p1b$pond_estudiante_reg_dep_tens)
data_p1c=data %>% select(P1_C,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p1c <- na.omit(data_p1c)
datap1c <- weighted.mean(data_p1c$P1_C, data_p1c$pond_estudiante_reg_dep_tens)
data_p1d=data %>% select(P1_D,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p1d <- na.omit(data_p1d)
datap1d <- weighted.mean(data_p1d$P1_D, data_p1d$pond_estudiante_reg_dep_tens)
pregunta_2019 <- rbind(datap1a,datap1b,datap1c,datap1d)
#pregunta_2019 <- pregunta_2019 %>% select(n,mean,sd,median,trimmed,min,max)
pregunta_2009$est <-  1 #
pregunta_2009$resp <- c("
<br>
<strong>
Permite  a  muchas  personas  hacer <br>
cambios a las leyes</strong></b>
<br>", "
<br>
<strong>
Hace que el sistema legal sea fácil <br>
de entender para los ciudadanos <br>
comunes y corrientes</strong></b>
<br>", "
<br>
<strong>
Significa  que  las  leyes   pueden <br>
mantenerse secretas hasta que se <br>
aplican en las cortes</strong></b>
<br>","
<br>
<strong><span style='color:#FF2D00'>
Significa que ningún grupo tiene <br>
todo el poder sobre las leyes <br>
(alternativa correcta) </span></strong></b>
<br>
")
pregunta_2019$est <-  2 #
pregunta_2019$resp <-  c("
<br>
<strong>
Permite  a  muchas  personas  hacer <br>
cambios a las leyes</strong></b>
<br>", "
<br>
<strong>
Hace que el sistema legal sea fácil <br>
de entender para los ciudadanos <br>
comunes y corrientes</strong></b>
<br>", "
<br>
<strong>
Significa  que  las  leyes   pueden <br>
mantenerse secretas hasta que se <br>
aplican en las cortes</strong></b>
<br>","
<br>
<strong><span style='color:#FF2D00'>
Significa que ningún grupo tiene <br>
todo el poder sobre las leyes <br>
(alternativa correcta) </span></strong></b>
<br>
")
table_pertot <-rbind(pregunta_2009,pregunta_2019)
View(pregunta_2019)
View(pregunta_2009)
