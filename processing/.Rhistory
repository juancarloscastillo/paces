<br>", "
<br>
<strong>
Un poco</strong></b>
<br>", "
<br>
<strong>
Bastante</strong></b>
<br>", "
<br>
<strong>
Completamente</strong></b>
<br>"))
p22C <- data_p22C %>%
group_by("Alternativas"=P22C) %>%
summarise(counts = n())
p22C <- p22C %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p22C <- ggplot(p22C, aes(WeightFunction(data_p22C$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿Cuánto confías en el siguiente grupo o institución?
Los partidos políticos", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p22C
data_p22D=data %>% select(P22D,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p22D <- na.omit(data_p22D)
data_p22D$P22D <- factor(data_p22D$P22D, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada</strong></b>
<br>", "
<br>
<strong>
Un poco</strong></b>
<br>", "
<br>
<strong>
Bastante</strong></b>
<br>", "
<br>
<strong>
Completamente</strong></b>
<br>"))
p22D <- data_p22D %>%
group_by("Alternativas"=P22D) %>%
summarise(counts = n())
p22D <- p22D %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p22D <- ggplot(p22D, aes(WeightFunction(data_p22D$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿Cuánto confías en el siguiente grupo o institución?
El Congreso Nacional", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p22D
data_p22E=data %>% select(P22E,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p22E <- na.omit(data_p22E)
data_p22E$P22E <- factor(data_p22E$P22E, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada</strong></b>
<br>", "
<br>
<strong>
Un poco</strong></b>
<br>", "
<br>
<strong>
Bastante</strong></b>
<br>", "
<br>
<strong>
Completamente</strong></b>
<br>"))
p22E <- data_p22E %>%
group_by("Alternativas"=P22E) %>%
summarise(counts = n())
p22E <- p22E %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p22E <- ggplot(p22E, aes(WeightFunction(data_p22E$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿Cuánto confías en el siguiente grupo o institución?
Los medios de comunicación (televisión, diario, radio)", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p22E
data_p22F=data %>% select(P22F,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p22F <- na.omit(data_p22F)
data_p22F$P22F <- factor(data_p22F$P22F, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada</strong></b>
<br>", "
<br>
<strong>
Un poco</strong></b>
<br>", "
<br>
<strong>
Bastante</strong></b>
<br>", "
<br>
<strong>
Completamente</strong></b>
<br>"))
p22F <- data_p22F %>%
group_by("Alternativas"=P22F) %>%
summarise(counts = n())
p22F <- p22F %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p22F <- ggplot(p22F, aes(WeightFunction(data_p22F$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿Cuánto confías en el siguiente grupo o institución?
Las personas en general", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p22F
load(file= "../input/data/proc/data1.Rdata")
table(data1$idschool)
load(file= "../input/data/proc/data1.Rdata")
View(data1)
View(data1)
data <- read_dta("../input/data/original/iccs_simce.dta")
#writeLines('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', con = "~/.Renviron")
#Sys.which("make")
library("haven")
library("dplyr")
library("sjmisc")
print(paste("R", getRversion()))
print("*** Versiones de librerías")
for (package_name in sort(loadedNamespaces())) {
print(paste(package_name, packageVersion(package_name)))
}
data <- read_dta("../input/data/original/iccs_simce.dta")
save(data, file= "../input/data/original/data.Rdata")
load(file= "../input/data/original/data.Rdata")
data1 = data %>% select("i_gen1"=IS3G24A,"i_gen2"=IS3G24B,"i_gen3"=IS3G24C,"i_gen4"=IS3G24D,"i_gen5"=IS3G24E,"i_gen6"=IS3G24F,"i_gen7"=IS3G24G,"i_etn1"=IS3G25A,"i_etn2"=IS3G25B,"i_etn3"=IS3G25C,"i_etn4"=IS3G25D,"i_etn5"=IS3G25E,"i_hom1"=LS3G08A,"i_hom2"=LS3G08B,"i_hom3"=LS3G08C,"i_hom4"=LS3G08D,"i_hom5"=LS3G08E,idschool) %>% as.data.frame()
data1$i_gen7 = as.numeric(gsub("<", ">", data1$i_gen7))
data1$i_gen3 <-sjmisc::rec(data1$i_gen3,rec="1=4;2=3;3=2;4=1;else=copy")
data1$i_gen4 <-sjmisc::rec(data1$i_gen4,rec="1=4;2=3;3=2;4=1;else=copy")
data1$i_gen6 <-sjmisc::rec(data1$i_gen6,rec="1=4;2=3;3=2;4=1;else=copy")
data1$i_gen7 <-sjmisc::rec(data1$i_gen7,rec="1=4;2=3;3=2;4=1;else=copy")
summary(data1)
save(data1, file= "../input/data/proc/data1.Rdata")
#sjPlot::view_df(data1, show.type = T)
library(dplyr)
library(knitr)
library(psych)
library(corrplot)
library(lavaan)
library(summarytools)
library(semPlot)
load(file= "../input/data/proc/data1.Rdata")
table(data1$idschool)
fit1<- cfa(model, data=data1, cluster = 'idschool', missing(fiml))
#table(data1$idschool)
data1$idschool[data1$idschool==1036]<-NA
data1$idschool[data1$idschool==1118]<-NA
data1$idschool[data1$idschool==1078]<-NA
data1$idschool[data1$idschool==1145]<-NA
data1$idschool[data1$idschool==1060]<-NA
data1$idschool[data1$idschool==1109]<-NA
data1 <- na.omit(data1)
model <- '
f.gen =~ i_gen1 + i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etn =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.hom =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
general =~  f.gen + f.etn + f.hom
'
fit1<- cfa(model  = model, data=data1, cluster = 'idschool')
summary(fit1, fit.measures=T, standardized=T)
save(fit1, file = "../output/tables/ajuste_modelo_1.Rdata")
## Al incorporar todos los colegios aparece un mensaje que advierte que algunos colegios no tienen variación dentro de la escuela. Se decidió eliminar del análisis las escuelas que aparecen en el mensaje:
#lavaan WARNING:
#    Level-1 variable �i_gen1� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1036 1118 1078 1145lavaan WARNING:
#    Level-1 variable �i_gen2� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1060 1118 1078lavaan WARNING:
#    Level-1 variable �i_gen5� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1118lavaan WARNING:
#    Level-1 variable �i_hom2� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1109lavaan WARNING: the optimizer warns that a solution has NOT been found!
load(file= "../input/data/proc/data1.Rdata")
#table(data1$idschool)
#data1$idschool[data1$idschool==1036]<-NA
#data1$idschool[data1$idschool==1118]<-NA
#data1$idschool[data1$idschool==1078]<-NA
#data1$idschool[data1$idschool==1145]<-NA
#data1$idschool[data1$idschool==1060]<-NA
#data1$idschool[data1$idschool==1109]<-NA
#data1 <- na.omit(data1)
model <- '
f.gen =~ i_gen1 + i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etn =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.hom =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
general =~  f.gen + f.etn + f.hom
'
fit1<- cfa(model  = model, data=data1, cluster = 'idschool')
summary(fit1, fit.measures=T, standardized=T)
save(fit1, file = "../output/tables/ajuste_modelo_1.Rdata")
## Al incorporar todos los colegios aparece un mensaje que advierte que algunos colegios no tienen variación dentro de la escuela. Se decidió eliminar del análisis las escuelas que aparecen en el mensaje:
#lavaan WARNING:
#    Level-1 variable �i_gen1� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1036 1118 1078 1145lavaan WARNING:
#    Level-1 variable �i_gen2� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1060 1118 1078lavaan WARNING:
#    Level-1 variable �i_gen5� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1118lavaan WARNING:
#    Level-1 variable �i_hom2� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1109lavaan WARNING: the optimizer warns that a solution has NOT been found!
print(dfSummary(data1, valid.col = FALSE, graph.magnif = 0.75),
max.tbl.height = 300, method = "render")
summary(data1)
#Análisis correlacional
cor <- polychoric(data1)
print(dfSummary(data1, valid.col = FALSE, graph.magnif = 0.75),
max.tbl.height = 300, method = "render")
summary(data1)
#Análisis correlacional
data_cor = data1 %>% select(-idschool) %>% as.data.frame()
cor <- polychoric(data_cor)
corrplot.mixed(cor$rho)
#Reducción de la base
data2 = data1 %>% select(i_gen2,i_gen3,i_gen4,i_gen5,i_gen6,i_gen7,i_etn1,i_etn2,i_etn3,i_etn4,i_etn5,i_hom1,i_hom2,i_hom3,i_hom4,i_hom5) %>% as.data.frame()
model2 <- '
f.genero =~ i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etnico =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.homosexual =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
f.general =~  f.genero + f.etnico + f.homosexual
'
fit2<- cfa(model2, data=data2, ordered =c("i_gen2","i_gen3","i_gen4","i_gen5","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"),cluster = "idschool")
#Reducción de la base
data2 = data1 %>% select(i_gen2,i_gen3,i_gen4,i_gen5,i_gen6,i_gen7,i_etn1,i_etn2,i_etn3,i_etn4,i_etn5,i_hom1,i_hom2,i_hom3,i_hom4,i_hom5,idschool) %>% as.data.frame()
model2 <- '
f.genero =~ i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etnico =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.homosexual =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
f.general =~  f.genero + f.etnico + f.homosexual
'
fit2<- cfa(model2, data=data2, ordered =c("i_gen2","i_gen3","i_gen4","i_gen5","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"),cluster = "idschool")
summary(fit2, fit.measures=T, standardized=T)
save(fit2, file = "../output/tables/ajuste_modelo_2.Rdata")
#table(data1$idschool)
#data1$idschool[data1$idschool==1036]<-NA
#data1$idschool[data1$idschool==1118]<-NA
#data1$idschool[data1$idschool==1078]<-NA
#data1$idschool[data1$idschool==1145]<-NA
#data1$idschool[data1$idschool==1060]<-NA
#data1$idschool[data1$idschool==1109]<-NA
#data1 <- na.omit(data1)
model <- '
f.gen =~ i_gen1 + i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etn =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.hom =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
general =~  f.gen + f.etn + f.hom
'
fit1<- cfa(model, data=data1, cluster = 'idschool')
summary(fit1, fit.measures=T, standardized=T)
save(fit1, file = "../output/tables/ajuste_modelo_1.Rdata")
## Al incorporar todos los colegios aparece un mensaje que advierte que algunos colegios no tienen variación dentro de la escuela. Se decidió eliminar del análisis las escuelas que aparecen en el mensaje:
#lavaan WARNING:
#    Level-1 variable �i_gen1� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1036 1118 1078 1145lavaan WARNING:
#    Level-1 variable �i_gen2� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1060 1118 1078lavaan WARNING:
#    Level-1 variable �i_gen5� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1118lavaan WARNING:
#    Level-1 variable �i_hom2� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1109lavaan WARNING: the optimizer warns that a solution has NOT been found!
model <- '
f.gen =~ i_gen1 + i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etn =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.hom =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
general =~  f.gen + f.etn + f.hom
'
fit1<- cfa(model, data=data1, cluster = 'idschool',
missing = "fiml")
summary(fitlat1, fit.measures = T, standardized = T, rsquare = TRUE)
model <- '
f.gen =~ i_gen1 + i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etn =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.hom =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
general =~  f.gen + f.etn + f.hom
'
fit1<- cfa(model, data=data1, cluster = 'idschool',
missing = "fiml")
summary(fit1, fit.measures = T, standardized = T, rsquare = TRUE)
save(fit1, file = "../output/tables/ajuste_modelo_1.Rdata")
## Al incorporar todos los colegios aparece un mensaje que advierte que algunos colegios no tienen variación dentro de la escuela. Se decidió eliminar del análisis las escuelas que aparecen en el mensaje:
#lavaan WARNING:
#    Level-1 variable �i_gen1� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1036 1118 1078 1145lavaan WARNING:
#    Level-1 variable �i_gen2� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1060 1118 1078lavaan WARNING:
#    Level-1 variable �i_gen5� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1118lavaan WARNING:
#    Level-1 variable �i_hom2� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1109lavaan WARNING: the optimizer warns that a solution has NOT been found!
print(dfSummary(data1, valid.col = FALSE, graph.magnif = 0.75),
max.tbl.height = 300, method = "render")
summary(data1)
#Análisis correlacional
data_cor = data1 %>% select(-idschool) %>% as.data.frame()
cor <- polychoric(data_cor)
corrplot.mixed(cor$rho)
print(dfSummary(data1, valid.col = FALSE, graph.magnif = 0.75),
max.tbl.height = 300, method = "render")
fit1<- cfa(model, data=data1, ordered =c("i_gen2","i_gen3","i_gen4","i_gen5","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"), cluster = 'idschool',
missing = "fiml")
model <- '
f.gen =~ i_gen1 + i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etn =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.hom =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
general =~  f.gen + f.etn + f.hom
'
fit1<- cfa(model, data=data1, ordered =c("i_gen2","i_gen3","i_gen4","i_gen5","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"), cluster = 'idschool')
model <- '
f.gen =~ i_gen1 + i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etn =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.hom =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
general =~  f.gen + f.etn + f.hom
'
fit1<- cfa(model, data=data1, ordered =c("i_gen2","i_gen3","i_gen4","i_gen5","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"), cluster = 'idschool')
fit1<- cfa(model, data=data1, ordered =c("i_gen2","i_gen3","i_gen4","i_gen5","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"), cluster = 'idschool')
fit1<- cfa(model, data=data1,  cluster = 'idschool')
summary(fit1, fit.measures = T, standardized = T, rsquare = TRUE)
model <- '
f.gen =~ i_gen1 + i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etn =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.hom =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
general =~  f.gen + f.etn + f.hom
'
fit1<- cfa(model, data=data1,  cluster = 'idschool',
missing = "fiml")
summary(fit1, fit.measures = T, standardized = T, rsquare = TRUE)
save(fit1, file = "../output/tables/ajuste_modelo_1.Rdata")
## Al incorporar todos los colegios aparece un mensaje que advierte que algunos colegios no tienen variación dentro de la escuela. Se decidió eliminar del análisis las escuelas que aparecen en el mensaje:
#lavaan WARNING:
#    Level-1 variable �i_gen1� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1036 1118 1078 1145lavaan WARNING:
#    Level-1 variable �i_gen2� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1060 1118 1078lavaan WARNING:
#    Level-1 variable �i_gen5� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1118lavaan WARNING:
#    Level-1 variable �i_hom2� has no variance within some clusters.
#    The cluster ids with zero within variance are: 1109lavaan WARNING: the optimizer warns that a solution has NOT been found!
model <- '
f.gen =~ i_gen1 + i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etn =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.hom =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
general =~  f.gen + f.etn + f.hom
'
fit1<- cfa(model, data=data1,  cluster = 'idschool',
missing = "fiml")
summary(fit1, fit.measures = T, standardized = T, rsquare = TRUE)
save(fit1, file = "../output/tables/ajuste_modelo_1.Rdata")
#Reducción de la base
data2 = data1 %>% select(i_gen2,i_gen3,i_gen4,i_gen5,i_gen6,i_gen7,i_etn1,i_etn2,i_etn3,i_etn4,i_etn5,i_hom1,i_hom2,i_hom3,i_hom4,i_hom5,idschool) %>% as.data.frame()
model2 <- '
f.genero =~ i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etnico =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.homosexual =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
f.general =~  f.genero + f.etnico + f.homosexual
'
fit2<- cfa(model2, data=data2, ordered =c("i_gen2","i_gen3","i_gen4","i_gen5","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"), cluster = "idschool")
summary(fit2, fit.measures=T, standardized=T)
save(fit2, file = "../output/tables/ajuste_modelo_2.Rdata")
model <- '
f.gen =~ i_gen1 + i_gen2 + i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etn =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.hom =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
general =~  f.gen + f.etn + f.hom
'
fit1<- cfa(model, data=data1, ordered =c("i_gen1","i_gen2","i_gen3","i_gen4","i_gen5","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"), cluster = "idschool")
summary(fit1, fit.measures = T, standardized = T, rsquare = TRUE)
save(fit1, file = "../output/tables/ajuste_modelo_1.Rdata")
#Reducción de la base
data3 = data1 %>% select(i_gen3,i_gen4,i_gen5,i_gen6,i_gen7,i_etn1,i_etn2,i_etn3,i_etn4,i_etn5,i_hom1,i_hom2,i_hom3,i_hom4,i_hom5) %>% as.data.frame()
model3 <- '
f.genero =~ i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etnico =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.homosexual =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
f.general =~  f.genero + f.etnico + f.homosexual
'
fit3<- cfa(model3, data=data3, ordered =c("i_gen3","i_gen4","i_gen5","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"), cluster = "idschool")
#Reducción de la base
data3 = data1 %>% select(i_gen3,i_gen4,i_gen5,i_gen6,i_gen7,i_etn1,i_etn2,i_etn3,i_etn4,i_etn5,i_hom1,i_hom2,i_hom3,i_hom4,i_hom5,idschool) %>% as.data.frame()
model3 <- '
f.genero =~ i_gen3 + i_gen4 + i_gen5 + i_gen6 + i_gen7
f.etnico =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.homosexual =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
f.general =~  f.genero + f.etnico + f.homosexual
'
fit3<- cfa(model3, data=data3, ordered =c("i_gen3","i_gen4","i_gen5","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"), cluster = "idschool")
summary(fit3, fit.measures=T, standardized=T,, rsquare = TRUE)
save(fit3, file = "../output/tables/ajuste_modelo_3.Rdata")
#Reducción de la base
data4 = data1 %>% select(i_gen3,i_gen4,i_gen6,i_gen7,i_etn1,i_etn2,i_etn3,i_etn4,i_etn5,i_hom1,i_hom2,i_hom3,i_hom4,i_hom5,idschool) %>% as.data.frame()
model4 <- '
f.genero =~ i_gen3 + i_gen4 + i_gen6 + i_gen7
f.etnico =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.homosexual =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
f.general =~  f.genero + f.etnico + f.homosexual
'
fit4<- cfa(model4, data=data4, ordered =c("i_gen3","i_gen4","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"), cluster = "idschool")
summary(fit4, fit.measures=T, standardized=T, rsquare = TRUE))
#Reducción de la base
data4 = data1 %>% select(i_gen3,i_gen4,i_gen6,i_gen7,i_etn1,i_etn2,i_etn3,i_etn4,i_etn5,i_hom1,i_hom2,i_hom3,i_hom4,i_hom5,idschool) %>% as.data.frame()
model4 <- '
f.genero =~ i_gen3 + i_gen4 + i_gen6 + i_gen7
f.etnico =~ i_etn1 + i_etn2 + i_etn3 + i_etn4 + i_etn5
f.homosexual =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
f.general =~  f.genero + f.etnico + f.homosexual
'
fit4<- cfa(model4, data=data4, ordered =c("i_gen3","i_gen4","i_gen6","i_gen7","i_etn1","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"), cluster = "idschool")
summary(fit4, fit.measures=T, standardized=T, rsquare = TRUE)
save(fit4, file = "../output/tables/ajuste_modelo_4.Rdata")
#Reducción de la base
data5 = data1 %>% select(i_gen3,i_gen4,i_gen6,i_gen7,i_etn2,i_etn3,i_etn4,i_etn5,i_hom1,i_hom2,i_hom3,i_hom4,i_hom5) %>% as.data.frame()
model5 <- '
f.genero =~ i_gen3 + i_gen4 + i_gen6 + i_gen7
f.etnico =~ i_etn2 + i_etn3 + i_etn4 + i_etn5
f.homosexual =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
f.general =~  f.genero + f.etnico + f.homosexual
'
#fit5<- cfa(model5, data=data5, ordered=c("i_gen3","i_gen4","i_gen6","i_gen7","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"))
fit5<- cfa(model5, data=data5, ordered=c("i_gen3","i_gen4","i_gen6","i_gen7","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5",std.lv=FALSE))
summary(fit5, fit.measures=T, standardized=T)
#Reducción de la base
data5 = data1 %>% select(i_gen3,i_gen4,i_gen6,i_gen7,i_etn2,i_etn3,i_etn4,i_etn5,i_hom1,i_hom2,i_hom3,i_hom4,i_hom5,idschool) %>% as.data.frame()
model5 <- '
f.genero =~ i_gen3 + i_gen4 + i_gen6 + i_gen7
f.etnico =~ i_etn2 + i_etn3 + i_etn4 + i_etn5
f.homosexual =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
f.general =~  f.genero + f.etnico + f.homosexual
'
#fit5<- cfa(model5, data=data5, ordered=c("i_gen3","i_gen4","i_gen6","i_gen7","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"))
fit5<- cfa(model5, data=data5, ordered=c("i_gen3","i_gen4","i_gen6","i_gen7","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5", cluster="idschool"))
summary(fit5, fit.measures=T, standardized=T, rsquare = TRUE))
#Reducción de la base
data5 = data1 %>% select(i_gen3,i_gen4,i_gen6,i_gen7,i_etn2,i_etn3,i_etn4,i_etn5,i_hom1,i_hom2,i_hom3,i_hom4,i_hom5,idschool) %>% as.data.frame()
model5 <- '
f.genero =~ i_gen3 + i_gen4 + i_gen6 + i_gen7
f.etnico =~ i_etn2 + i_etn3 + i_etn4 + i_etn5
f.homosexual =~ i_hom1 + i_hom2 + i_hom3 + i_hom4 + i_hom5
f.general =~  f.genero + f.etnico + f.homosexual
'
#fit5<- cfa(model5, data=data5, ordered=c("i_gen3","i_gen4","i_gen6","i_gen7","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"))
fit5<- cfa(model5, data=data5, ordered=c("i_gen3","i_gen4","i_gen6","i_gen7","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5", cluster="idschool"))
summary(fit5, fit.measures=T, standardized=T, rsquare = TRUE)
save(fit5, file = "../output/tables/ajuste_modelo_5.Rdata")
ajuste_modelo_5 <- load(file = "../output/tables/ajuste_modelo_5.Rdata")
semPaths(fit5,
style = "lisrel",
label.cex=1.5,
edge.label.cex=3,
residuals=F,
edge.color = "Black",
thresholds= F,#Esto saca las lineas dentro de los cuadrados que representan las variables.
intercepts = F,
shapeInt = "Null",
structural = F,
freeStyle = 1,
pastel =F,
layoutSplit = F,
rainbowStart = 0,
exoCov = F,
color = "white",
panelGroups = T,
subRes = 4,
covAtResiduals = F,
reorder = FALSE,
nodeLabels = c("i_gen3","i_gen4","i_gen6","i_gen7","i_etn2","i_etn3","i_etn4","i_etn5","i_hom1","i_hom2","i_hom3","i_hom4","i_hom5"),
rotation = 2)
#semPaths(fit5)
