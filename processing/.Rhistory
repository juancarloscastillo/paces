summarise(counts = n())
p5G <- p5G %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p5G <- ggplot(p5G, aes(WeightFunction(dataapod_p5G$pond_apoderado_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿En qué medida estás de acuerdo o en desacuerdo con la siguiente
afirmación sobre los gobiernos y sus lideres?  La concentración
del poder ayuda a mantener el orden", subtitle="Respuestas de los apoderados") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p5G
# Estudiantes
data_p21H=data %>% select(P21H,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p21H <- na.omit(data_p21H)
data_p21H$P21H <- factor(data_p21H$P21H, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Muy en desacuerdo</strong></b>
<br>", "
<br>
<strong>
En desacuerdo</strong></b>
<br>", "
<br>
<strong>
De acuerdo</strong></b>
<br>", "
<br>
<strong>
Muy de acuerdo</strong></b>
<br>"))
p21H <- data_p21H %>%
group_by("Alternativas"=P21H) %>%
summarise(counts = n())
p21H <- p21H %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p21H <- ggplot(p21H, aes(WeightFunction(data_p21H$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿En qué medida estás de acuerdo o en desacuerdo con la siguiente
afirmación sobre los gobiernos y sus lideres?  Los gobiernos
autoritarios se justifican cuando traen orden y seguridad", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p21H
# Docentes
dataprof_p18H=dataprof %>% select(P18H,pond_prof_reg_dep_tens) %>% as.data.frame
dataprof_p18H <- na.omit(dataprof_p18H)
dataprof_p18H$P18H <- factor(dataprof_p18H$P18H, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Muy en desacuerdo</strong></b>
<br>", "
<br>
<strong>
En desacuerdo</strong></b>
<br>", "
<br>
<strong>
De acuerdo</strong></b>
<br>", "
<br>
<strong>
Muy de acuerdo</strong></b>
<br>"))
p18H <- dataprof_p18H %>%
group_by("Alternativas"=P18H) %>%
summarise(counts = n())
p18H <- p18H %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p18H <- ggplot(p18H, aes(WeightFunction(dataprof_p18H$pond_prof_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿En qué medida estás de acuerdo o en desacuerdo con la siguiente
afirmación sobre los gobiernos y sus lideres?  Los gobiernos
autoritarios se justifican cuando traen orden y seguridad", subtitle="Respuestas de los docentes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p18H
# Apoderados
dataapod_p5H=dataapod %>% select(P5H,pond_apoderado_reg_dep_tens) %>% as.data.frame
dataapod_p5H <- na.omit(dataapod_p5H)
dataapod_p5H$P5H <- factor(dataapod_p5H$P5H, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Muy en desacuerdo</strong></b>
<br>", "
<br>
<strong>
En desacuerdo</strong></b>
<br>", "
<br>
<strong>
De acuerdo</strong></b>
<br>", "
<br>
<strong>
Muy de acuerdo</strong></b>
<br>"))
p5H <- dataapod_p5H %>%
group_by("Alternativas"=P5H) %>%
summarise(counts = n())
p5H <- p5H %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p5H <- ggplot(p5H, aes(WeightFunction(dataapod_p5H$pond_apoderado_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿En qué medida estás de acuerdo o en desacuerdo con la siguiente
afirmación sobre los gobiernos y sus lideres?  Los gobiernos
autoritarios se justifican cuando traen orden y seguridad", subtitle="Respuestas de los apoderados") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p5H
# Estudiantes
data_p21I=data %>% select(P21I,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p21I <- na.omit(data_p21I)
data_p21I$P21I <- factor(data_p21I$P21I, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Muy en desacuerdo</strong></b>
<br>", "
<br>
<strong>
En desacuerdo</strong></b>
<br>", "
<br>
<strong>
De acuerdo</strong></b>
<br>", "
<br>
<strong>
Muy de acuerdo</strong></b>
<br>"))
p21I <- data_p21I %>%
group_by("Alternativas"=P21I) %>%
summarise(counts = n())
p21I <- p21I %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p21I <- ggplot(p21I, aes(WeightFunction(data_p21I$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿En qué medida estás de acuerdo o en desacuerdo con la siguiente
afirmación sobre los gobiernos y sus lideres? Los gobiernos
autoritarios se justifican cuando traen beneficios económicos", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p21I
# Docentes
dataprof_p18I=dataprof %>% select(P18I,pond_prof_reg_dep_tens) %>% as.data.frame
dataprof_p18I <- na.omit(dataprof_p18I)
dataprof_p18I$P18I <- factor(dataprof_p18I$P18I, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Muy en desacuerdo</strong></b>
<br>", "
<br>
<strong>
En desacuerdo</strong></b>
<br>", "
<br>
<strong>
De acuerdo</strong></b>
<br>", "
<br>
<strong>
Muy de acuerdo</strong></b>
<br>"))
p18I <- dataprof_p18I %>%
group_by("Alternativas"=P18I) %>%
summarise(counts = n())
p18I <- p18I %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p18I <- ggplot(p18I, aes(WeightFunction(dataprof_p18I$pond_prof_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿En qué medida estás de acuerdo o en desacuerdo con la siguiente
afirmación sobre los gobiernos y sus lideres? Los gobiernos
autoritarios se justifican cuando traen beneficios económicos", subtitle="Respuestas de los docentes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p18I
# Apoderados
dataapod_p5I=dataapod %>% select(P5I,pond_apoderado_reg_dep_tens) %>% as.data.frame
dataapod_p5I <- na.omit(dataapod_p5I)
dataapod_p5I$P5I <- factor(dataapod_p5I$P5I, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Muy en desacuerdo</strong></b>
<br>", "
<br>
<strong>
En desacuerdo</strong></b>
<br>", "
<br>
<strong>
De acuerdo</strong></b>
<br>", "
<br>
<strong>
Muy de acuerdo</strong></b>
<br>"))
p5I <- dataapod_p5I %>%
group_by("Alternativas"=P5I) %>%
summarise(counts = n())
p5I <- p5I %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p5I <- ggplot(p5I, aes(WeightFunction(dataapod_p5I$pond_apoderado_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿En qué medida estás de acuerdo o en desacuerdo con la siguiente
afirmación sobre los gobiernos y sus lideres? Los gobiernos
autoritarios se justifican cuando traen beneficios económicos", subtitle="Respuestas de los apoderados") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p5I
data_p22A=data %>% select(P22A,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p22A <- na.omit(data_p22A)
data_p22A$P22A <- factor(data_p22A$P22A, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada</strong></b>
<br>", "
<br>
<strong>
Un poco</strong></b>
<br>", "
<br>
<strong>
Bastante</strong></b>
<br>", "
<br>
<strong>
Completamente</strong></b>
<br>"))
p22A <- data_p22A %>%
group_by("Alternativas"=P22A) %>%
summarise(counts = n())
p22A <- p22A %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p22A <- ggplot(p22A, aes(WeightFunction(data_p22A$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿Cuánto confías en el siguiente grupo o institución?
El gobierno de Chile", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p22A
data_p22B=data %>% select(P22B,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p22B <- na.omit(data_p22B)
data_p22B$P22B <- factor(data_p22B$P22B, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada</strong></b>
<br>", "
<br>
<strong>
Un poco</strong></b>
<br>", "
<br>
<strong>
Bastante</strong></b>
<br>", "
<br>
<strong>
Completamente</strong></b>
<br>"))
p22B <- data_p22B %>%
group_by("Alternativas"=P22B) %>%
summarise(counts = n())
p22B <- p22B %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p22B <- ggplot(p22B, aes(WeightFunction(data_p22B$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿Cuánto confías en el siguiente grupo o institución?
Los Tribunales de Justicia", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p22B
data_p22C=data %>% select(P22C,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p22C <- na.omit(data_p22C)
data_p22C$P22C <- factor(data_p22C$P22C, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada</strong></b>
<br>", "
<br>
<strong>
Un poco</strong></b>
<br>", "
<br>
<strong>
Bastante</strong></b>
<br>", "
<br>
<strong>
Completamente</strong></b>
<br>"))
p22C <- data_p22C %>%
group_by("Alternativas"=P22C) %>%
summarise(counts = n())
p22C <- p22C %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p22C <- ggplot(p22C, aes(WeightFunction(data_p22C$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿Cuánto confías en el siguiente grupo o institución?
Los partidos políticos", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p22C
data_p22D=data %>% select(P22D,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p22D <- na.omit(data_p22D)
data_p22D$P22D <- factor(data_p22D$P22D, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada</strong></b>
<br>", "
<br>
<strong>
Un poco</strong></b>
<br>", "
<br>
<strong>
Bastante</strong></b>
<br>", "
<br>
<strong>
Completamente</strong></b>
<br>"))
p22D <- data_p22D %>%
group_by("Alternativas"=P22D) %>%
summarise(counts = n())
p22D <- p22D %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p22D <- ggplot(p22D, aes(WeightFunction(data_p22D$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿Cuánto confías en el siguiente grupo o institución?
El Congreso Nacional", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p22D
data_p22E=data %>% select(P22E,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p22E <- na.omit(data_p22E)
data_p22E$P22E <- factor(data_p22E$P22E, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada</strong></b>
<br>", "
<br>
<strong>
Un poco</strong></b>
<br>", "
<br>
<strong>
Bastante</strong></b>
<br>", "
<br>
<strong>
Completamente</strong></b>
<br>"))
p22E <- data_p22E %>%
group_by("Alternativas"=P22E) %>%
summarise(counts = n())
p22E <- p22E %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p22E <- ggplot(p22E, aes(WeightFunction(data_p22E$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿Cuánto confías en el siguiente grupo o institución?
Los medios de comunicación (televisión, diario, radio)", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p22E
data_p22F=data %>% select(P22F,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p22F <- na.omit(data_p22F)
data_p22F$P22F <- factor(data_p22F$P22F, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Nada</strong></b>
<br>", "
<br>
<strong>
Un poco</strong></b>
<br>", "
<br>
<strong>
Bastante</strong></b>
<br>", "
<br>
<strong>
Completamente</strong></b>
<br>"))
p22F <- data_p22F %>%
group_by("Alternativas"=P22F) %>%
summarise(counts = n())
p22F <- p22F %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p22F <- ggplot(p22F, aes(WeightFunction(data_p22F$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=7) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("¿Cuánto confías en el siguiente grupo o institución?
Las personas en general", subtitle="Respuestas de los estudiantes") +
theme(plot.title = element_text(size = 17.5, face = "bold",hjust=0.5),
plot.subtitle = element_text(size = 16,hjust = 0.5, face = "bold"))
plot_p22F
