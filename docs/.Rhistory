Seguro haré esto</strong></b>
<br>"))
p31B <- data_p31B %>%
group_by("Alternativas"=P31B) %>%
summarise(counts = n())
p31B <- p31B %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p31B <- ggplot(p31B, aes(WeightFunction(data_p31B$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("<br><br><br><strong><span style='font-size:25px'>A continuación, encontrarás una lista con distintas maneras en que los <br> adultos pueden participar activamente de la vida política. <br> Cuando seas adulto(a), ¿qué crees que vas a hacer?</span></strong><br>",subtitle="<strong><span style='font-size:28px'><br>Votar en las elecciones <br> presidenciales </span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
legend.position = "bottom",
plot.subtitle = element_markdown(hjust = 0.5),
legend.title = element_blank())
plot_p31B
data_p31C=data %>% select(P31C,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p31C <- na.omit(data_p31C)
data_p31C$P31C <- factor(data_p31C$P31C, levels = c(1,2,3,4), labels = c("
<br>
<strong>
Seguro no haré esto</strong></b>
<br>", "
<br>
<strong>
Tal vez haré esto</strong></b>
<br>","
<br>
<strong>
Probablemente haré<br>
esto</strong></b>
<br>", "
<br>
<strong>
Seguro haré esto</strong></b>
<br>"))
p31C <- data_p31C %>%
group_by("Alternativas"=P31C) %>%
summarise(counts = n())
p31C <- p31C %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p31C <- ggplot(p31C, aes(WeightFunction(data_p31C$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("",subtitle="<br><br><br><br><br><strong><span style='font-size:28px'>Informarme sobre los <br>
candidatos antes de <br>
votar en una elección</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
legend.position = "none",
plot.subtitle = element_markdown(hjust = 0.5))
plot_p31C
partform2 <- cowplot::plot_grid(plot_p31A,plot_p31B,plot_p31C, ncol=3)
ggsave(partform2, file = "../output/graphs/graph_partform_fut.png",device = "png",width = 30,height = 20,dpi = "retina",units = "cm")
data_p30D=data %>% select(P30D,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p30D <- na.omit(data_p30D)
data_p30D$P30D <- factor(data_p30D$P30D, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p30D <- data_p30D %>%
group_by("Alternativas"=P30D) %>%
summarise(counts = n())
p30D <- p30D %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p30D <- ggplot(p30D, aes(WeightFunction(data_p30D$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<br><br><br><br><strong><span style='font-size:28px'>Participar en una protesta <br>en la escuela</span></strong><br>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p30D
data_p30E=data %>% select(P30E,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p30E <- na.omit(data_p30E)
data_p30E$P30E <- factor(data_p30E$P30E, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p30E <- data_p30E %>%
group_by("Alternativas"=P30E) %>%
summarise(counts = n())
p30E <- p30E %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p30E <- ggplot(p30E, aes(WeightFunction(data_p30E$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_blank()) +
theme(legend.text = element_markdown(colour = "grey20", size =18)) +
ggtitle("<br><br><br><strong><span style='font-size:25px'>¿Has realizado la siguiente actividad al interior de la escuela durante <br> los últimos dos semestres?</span></strong><br>",subtitle="<strong><span style='font-size:28px'>
Tomar un rol activo en una <br>
reunión o asamblea  de <br>
estudiantes</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
legend.position = "bottom",
plot.subtitle = element_markdown(hjust = 0.5))
plot_p30E
data_p30F=data %>% select(P30F,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p30F <- na.omit(data_p30F)
data_p30F$P30F <- factor(data_p30F$P30F, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p30F <- data_p30F %>%
group_by("Alternativas"=P30F) %>%
summarise(counts = n())
p30F <- p30F %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p30F <- ggplot(p30F, aes(WeightFunction(data_p30F$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<br><br><br><br><strong><span style='font-size:28px'>Usar una polera o símbolo <br> con un mensaje político</span></strong><br>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p30F
partact1 <- cowplot::plot_grid(plot_p30D,plot_p30E,plot_p30F, ncol=3)
ggsave(partact1, file = "../output/graphs/graph_partact_esc.png",device = "png",width = 30,height = 20,dpi = "retina",units = "cm")
data_p33A=data %>% select(P33A,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33A <- na.omit(data_p33A)
data_p33A$P33A <- factor(data_p33A$P33A, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33A <- data_p33A %>%
group_by("Alternativas"=P33A) %>%
summarise(counts = n())
p33A <- p33A %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33A <- ggplot(p33A, aes(WeightFunction(data_p33A$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =16)) +
ggtitle(" ",subtitle="<strong><span style='font-size:28px'>Firmar una petición</span></strong>") +
theme(plot.title = element_markdown(hjust=0),
legend.position = "bottom",
plot.subtitle = element_markdown(hjust = 0.5),
legend.title = element_blank(),
legend.justification = c(-0.15, 1))
plot_p33A
data_p33B=data %>% select(P33B,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33B <- na.omit(data_p33B)
data_p33B$P33B <- factor(data_p33B$P33B, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33B <- data_p33B %>%
group_by("Alternativas"=P33B) %>%
summarise(counts = n())
p33B <- p33B %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33B <- ggplot(p33B, aes(WeightFunction(data_p33B$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("<br><br><br><strong><span style='font-size:25px'>¿Has realizado la siguiente actividad durante los últimos 12 meses?</span></strong><br>",subtitle = "<strong><span style='font-size:28px'>Participar en una marcha <br> o manifestación pacífica</span></strong><br>") +
theme(plot.title = element_markdown(hjust=-0.35),
legend.position = "none",
plot.subtitle = element_markdown(hjust = 0.5))
plot_p33B
data_p33C=data %>% select(P33C,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33C <- na.omit(data_p33C)
data_p33C$P33C <- factor(data_p33C$P33C, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33C <- data_p33C %>%
group_by("Alternativas"=P33C) %>%
summarise(counts = n())
p33C <- p33C %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33C <- ggplot(p33C, aes(WeightFunction(data_p33C$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =16)) +
ggtitle(" ",subtitle="<br><br><br><br><br><strong><span style='font-size:28px'>
Participar en una marcha <br>
o manifestación que resultó<br>
en destrucción de propiedad</span></strong>") +
theme(plot.title = element_markdown(hjust=0),
legend.position = "none",
plot.subtitle = element_markdown(hjust = 0.5))
plot_p33C
data_p33D=data %>% select(P33D,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33D <- na.omit(data_p33D)
data_p33D$P33D <- factor(data_p33D$P33D, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33D <- data_p33D %>%
group_by("Alternativas"=P33D) %>%
summarise(counts = n())
p33D <- p33D %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33D <- ggplot(p33D, aes(WeightFunction(data_p33D$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<strong><span style='font-size:28px'>Participar en una toma</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p33D
partact2a <- cowplot::plot_grid(plot_p33B,plot_p33C, ncol=2)
partact2b <- cowplot::plot_grid(plot_p33D,plot_p33A, ncol=2)
partact2 <- cowplot::plot_grid(partact2a,partact2b, ncol=1)
ggsave(partact2, file = "../output/graphs/graph_partact.png",device = "png",width = 30,height = 35,dpi = "retina",units = "cm")
#ggsave(partact2, file = "../output/graphs/graph_partact.png",device = "png",width = 25,height = 18,dpi = "retina",units = "cm")
data_p30G=data %>% select(P30G,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p30G <- na.omit(data_p30G)
data_p30G$P30G <- factor(data_p30G$P30G, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p30G <- data_p30G %>%
group_by("Alternativas"=P30G) %>%
summarise(counts = n())
p30G <- p30G %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p30G <- ggplot(p30G, aes(WeightFunction(data_p30G$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<br><br><br><br><strong><span style='font-size:28px'>Trabajos voluntarios <br> de ayuda</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p30G
data_p30H=data %>% select(P30H,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p30H <- na.omit(data_p30H)
data_p30H$P30H <- factor(data_p30H$P30H, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p30H <- data_p30H %>%
group_by("Alternativas"=P30H) %>%
summarise(counts = n())
p30H <- p30H %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p30H <- ggplot(p30H, aes(WeightFunction(data_p30H$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("<br><br><br><strong><span style='font-size:25px'>¿Has realizado la siguiente actividad al interior de la escuela durante <br> los últimos dos semestres?</span></strong><br>",subtitle="<strong><span style='font-size:28px'>
Colectas de dineros o bienes <br> para ayudar a otros</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
legend.position = "bottom",
plot.subtitle = element_markdown(hjust = 0.5),
legend.title = element_blank())
plot_p30H
data_p30I=data %>% select(P30I,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p30I <- na.omit(data_p30I)
data_p30I$P30I <- factor(data_p30I$P30I, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p30I <- data_p30I %>%
group_by("Alternativas"=P30I) %>%
summarise(counts = n())
p30I <- p30I %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p30I <- ggplot(p30I, aes(WeightFunction(data_p30I$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<br><br><br><br><strong><span style='font-size:28px'>Actividades de ayuda <br> a la comunidad</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p30I
partcom1 <- cowplot::plot_grid(plot_p30G,plot_p30H,plot_p30I, ncol=3)
ggsave(partcom1, file = "../output/graphs/graph_partcom_esc.png",device = "png",width = 30,height = 20,dpi = "retina",units = "cm")
data_p33E=data %>% select(P33E,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33E <- na.omit(data_p33E)
data_p33E$P33E <- factor(data_p33E$P33E, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33E <- data_p33E %>%
group_by("Alternativas"=P33E) %>%
summarise(counts = n())
p33E <- p33E %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33E <- ggplot(p33E, aes(WeightFunction(data_p33E$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<br><br><br><br><br><strong><span style='font-size:28px'>Donar dinero por <br> una buena causa</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p33E
data_p33F=data %>% select(P33F,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33F <- na.omit(data_p33F)
data_p33F$P33F <- factor(data_p33F$P33F, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33F <- data_p33F %>%
group_by("Alternativas"=P33F) %>%
summarise(counts = n())
p33F <- p33F %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33F <- ggplot(p33F, aes(WeightFunction(data_p33F$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle("<br><br><br><strong><span style='font-size:25px'>¿Has realizado la siguiente actividad durante los últimos 12 meses?</span></strong><br>",subtitle="<strong><span style='font-size:28px'> <br>
Trabajar como <br>
voluntario por ayudar <br>
personas de tu comunidad</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
legend.position = "bottom",
plot.subtitle = element_markdown(hjust = 0.5),
legend.title = element_blank())
plot_p33F
data_p33G=data %>% select(P33G,pond_estudiante_reg_dep_tens) %>% as.data.frame
data_p33G <- na.omit(data_p33G)
data_p33G$P33G <- factor(data_p33G$P33G, levels = c(1,2), labels = c("
<br>
<strong>
Sí</strong></b>
<br>", "
<br>
<strong>
No</strong></b>
<br>"))
p33G <- data_p33G %>%
group_by("Alternativas"=P33G) %>%
summarise(counts = n())
p33G <- p33G %>%
arrange(desc(Alternativas)) %>%
mutate(prop = round(counts*100/sum(counts), 2),
lab.ypos = cumsum(prop) - 0.5*prop)
plot_p33G <- ggplot(p33G, aes(WeightFunction(data_p33G$pond_estudiante_reg_dep_tens), x = 2, y = prop, fill = Alternativas)) +
geom_bar(stat = "identity", color = "white") +
coord_polar(theta = "y", start = 1.5)+
geom_text(aes(label = format(paste(round(prop,1),"%"), big.mark = ",", scientific = FALSE), y = lab.ypos), color = "black", size=6) +
scale_fill_brewer(palette = "Purples") +
theme_void()+
xlim(0.5, 2.5) +
theme(legend.title = element_text(size=16, face="bold")) +
theme(legend.text = element_markdown(colour = "grey20", size =14)) +
ggtitle(" ",subtitle = "<br><br><br><br><strong><span style='font-size:28px'> Participar de una <br>
actividad social en la <br>
comunidad en que vives</span></strong>") +
theme(plot.title = element_markdown(hjust=0.5),
plot.subtitle = element_markdown(hjust=0.5),
legend.position = "none")
plot_p33G
partcom2 <- cowplot::plot_grid(plot_p33E,plot_p33F,plot_p33G, ncol=3)
ggsave(partcom2, file = "../output/graphs/graph_partcom.png",device = "png",width = 30,height = 20,dpi = "retina",units = "cm")
